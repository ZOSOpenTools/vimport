diff --git a/src/buffer.c b/src/buffer.c
index 58e9718e3..d37bcca46 100644
--- a/src/buffer.c
+++ b/src/buffer.c
@@ -26,6 +26,7 @@
  */
 
 #include "vim.h"
+#include <_Nascii.h>
 
 
 #ifdef FEAT_EVAL
@@ -71,6 +72,21 @@ static int	buf_free_count = 0;
 static int	top_file_num = 1;	// highest file number
 static garray_T buf_reuse = GA_EMPTY;	// file numbers to recycle
 
+
+#ifdef __MVS__
+int is_dataset(const char *filename) {
+  if (filename == NULL || strlen(filename) < 2) {
+    return 0;
+  }
+
+  if (filename[0] == '/' && filename[1] == '/') {
+    return 1;
+  }
+
+  return 0;
+}
+#endif
+
 /*
  * Return the highest possible buffer number.
  */
@@ -2101,6 +2117,56 @@ buflist_new(
     if (top_file_num == 1)
 	hash_init(&buf_hashtab);
 
+  // Dataset I/O
+#ifdef __MVS__
+    if (ffname != NULL)
+    {
+      if (is_dataset(ffname)) {
+         
+        __a2e_s(ffname);
+        __ae_thread_swapmode(__AE_EBCDIC_MODE);
+        struct DFILE* dsfile = open_dataset(ffname);
+        __ae_thread_swapmode(__AE_ASCII_MODE);
+        if (!dsfile)
+          return NULL;
+
+        __ae_thread_swapmode(__AE_EBCDIC_MODE);
+        if (read_dataset(dsfile)) {
+          __ae_thread_swapmode(__AE_ASCII_MODE);
+          return NULL;
+        }
+        __ae_thread_swapmode(__AE_ASCII_MODE);
+
+        curbuf->dsfile = dsfile;
+        curbuf->is_dataset = 1; // Maybe we can just check dsfile != NULL?
+
+        // Create a temporary file to represent the dataset
+        ffname = vim_tempname('z', TRUE);
+        sfname = ffname;
+        
+        int temp_fd;
+        //TODO: Copy permissions from dataset?
+        if ((temp_fd = open(ffname, O_WRONLY | O_CREAT | O_TRUNC, 0666)) == -1) {
+          close_dataset(dsfile);
+          close(temp_fd);
+          return NULL;
+        }
+        __disableautocvt(temp_fd);
+
+        if (write(temp_fd, dsfile->buffer, dsfile->bufflen) != dsfile->bufflen) {
+          close_dataset(dsfile);
+          close(temp_fd);
+          return NULL;
+        }
+
+        //TODO: Use the locale's codepage
+        __chgfdccsid(temp_fd, 1047);
+
+        close_dataset(dsfile);
+        close(temp_fd);
+      } 
+    } 
+#endif
     fname_expand(curbuf, &ffname, &sfname);	// will allocate ffname
 
     /*
@@ -2195,9 +2261,10 @@ buflist_new(
 
     if (ffname != NULL)
     {
-	buf->b_ffname = ffname;
-	buf->b_sfname = vim_strsave(sfname);
+      buf->b_ffname = ffname;
+      buf->b_sfname = vim_strsave(sfname);
     }
+   
 
     clear_wininfo(buf);
     buf->b_wininfo = ALLOC_CLEAR_ONE(wininfo_T);
